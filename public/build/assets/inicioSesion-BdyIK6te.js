document.addEventListener("DOMContentLoaded",function(){const o=document.getElementById("loginForm"),c=document.getElementById("registerForm"),s=document.getElementById("resetForm"),d=document.getElementById("toggleRegister"),u=document.getElementById("toggleReset");let m=document.querySelector(".alert");m&&setTimeout(function(){m.classList.add("hidden")},5e3);function g(t){const n=document.createElement("div"),e=t==="error"?"bg-red-100 border border-red-400 text-red-700":"bg-green-100 border border-green-400 text-green-700";return n.className=`${e} px-4 py-3 rounded relative my-4 hidden`,n}function l(t){[o,c,s].forEach(n=>{n&&(n.style.display="none")}),t&&(t.style.display="block")}function i(t,n){t&&(t.innerHTML="",t.classList.remove("hidden"),typeof n=="string"&&(n={general:[n]}),Object.values(n).flat().forEach(e=>{const r=document.createElement("p");r.textContent=e,t.appendChild(r)}))}function a(t){t.querySelectorAll(".message-container").forEach(e=>{e.innerHTML="",e.classList.add("hidden")})}[o,c,s].forEach(t=>{if(t){const n=g("error"),e=g("success");n.classList.add("message-container","error-container"),e.classList.add("message-container","success-container"),t.appendChild(n),t.appendChild(e)}}),d.addEventListener("click",()=>{o.style.display!=="none"?(l(c),d.textContent="¿Ya tienes cuenta? Inicia sesión",u.style.display="none"):(l(o),d.textContent="¿No tienes cuenta? Regístrate",u.style.display="block"),a(o),a(c)}),u.addEventListener("click",()=>{s.style.display==="none"?(l(s),u.textContent="Volver al inicio de sesión",d.style.display="none"):(l(o),u.textContent="¿Olvidaste tu contraseña?",d.style.display="block"),a(o),a(s)}),c.addEventListener("submit",function(t){t.preventDefault();const n=new FormData(this);a(c),fetch(this.action,{method:"POST",body:n,headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},credentials:"same-origin"}).then(e=>e.json()).then(e=>{if(e.errors){const r=c.querySelector(".error-container");i(r,e.errors)}else if(e.success){l(o);const r=o.querySelector(".success-container");i(r,{message:[e.message]}),c.reset()}}).catch(e=>{console.error("Error:",e);const r=c.querySelector(".error-container");i(r,{general:["Hubo un problema al procesar tu solicitud. Por favor, inténtalo de nuevo."]})})}),o.addEventListener("submit",function(t){t.preventDefault();const n=new FormData(this);a(o),fetch(this.action,{method:"POST",body:n,headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},credentials:"same-origin"}).then(e=>e.json()).then(e=>{if(e.success)window.location.href=e.redirect;else if(e.errors){const r=o.querySelector(".error-container");i(r,e.errors)}}).catch(e=>{console.error("Error:",e);const r=o.querySelector(".error-container");i(r,{general:["Hubo un problema al iniciar sesión. Por favor, inténtalo de nuevo."]})})}),s.addEventListener("submit",function(t){t.preventDefault();const n=new FormData(this);a(s),fetch(this.action,{method:"POST",body:n,headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},credentials:"same-origin"}).then(e=>e.json()).then(e=>{if(e.success){const r=s.querySelector(".success-container");i(r,{message:[e.message]})}else if(e.errors){const r=s.querySelector(".error-container");i(r,e.errors)}}).catch(e=>{console.error("Error:",e);const r=s.querySelector(".error-container");i(r,{general:["Hubo un problema al procesar tu solicitud. Por favor, inténtalo de nuevo."]})})}),window.toggleForm=function(t){const n=document.getElementById(t);l(n),a(n)}});
